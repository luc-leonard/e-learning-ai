<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jour 6 ‚Äî Transformer le code</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèóÔ∏è</text></svg>">
</head>
<body>
  <div class="app">
    <div id="sidebar-root"></div>
    <main class="main-content">
      <div class="module-content">

<h1>Jour 6 : Transformer le code</h1>
<p class="module-subtitle"><em>Module 9 ‚Äî Le monolithe qui enfle</em></p>
<hr>
<h3>Avant de commencer</h3>
<p>Au Jour 8 du Module 8, vous aviez v√©cu le moment d√©clic : votre plan devenait du code. Aujourd'hui, c'est un moment similaire ‚Äî vos √©v√©nements en fran√ßais deviennent de vrais √©v√©nements dans le code. Vous allez transformer les appels directs qui sont des <strong>annonces</strong> en √©v√©nements PubSub.</p>
<div class="module-meta">
<div class="module-meta-item"><strong>Dur√©e :</strong> 1h30-2h</div>
<div class="module-meta-item"><strong>Ce qu'il vous faut :</strong> Votre dossier `mon_club` ouvert dans VSCode, Claude Code, votre carnet</div>
</div>
<hr>
<h3>Ce que vous allez faire</h3>
<p>Quittez Claude Code (<code>/exit</code>) et relancez une nouvelle session :</p>
<pre data-lang="bash"><code>claude</code></pre>
<p>Vous allez donner √† Claude Code une mission pr√©cise, bas√©e sur le travail des jours pr√©c√©dents :</p>
<blockquote>
<p>Lis plan.md et le code du projet.</p>
<p>Voici les √©v√©nements que je veux ajouter dans le projet :</p>
<ul>
<li>Quand un membre s'inscrit √† une r√©union ‚Üí publier un √©v√©nement {:membre_inscrit_reunion, ...}</li>
<li>Quand un vote est enregistr√© pour un livre ‚Üí publier un √©v√©nement {:vote_enregistre, ...}</li>
</ul>
<p>Pour chaque contexte, ajoute les publications PubSub apr√®s les actions r√©ussies. Cr√©e les listeners n√©cessaires. Garde les appels directs qui sont des questions (v√©rifier qu'un membre existe, etc.).</p>
<p>Mets √† jour plan.md pour documenter les √©v√©nements.</p>
</blockquote>
<p>Adaptez les √©v√©nements √† ce que vous avez √©crit dans votre carnet au Jour 4. Les noms exacts d√©pendent de votre projet.</p>
<h3>Apr√®s la transformation</h3>
<p>Une fois que Claude a fini, v√©rifiez que le site fonctionne toujours :</p>
<pre data-lang="bash"><code>mix phx.server</code></pre>
<p>Testez dans le navigateur. Les fonctionnalit√©s doivent marcher exactement comme avant ‚Äî la diff√©rence est invisible pour l'utilisateur, elle est dans la fa√ßon dont le code est organis√©.</p>
<h3>Le nouveau sch√©ma de fl√®ches</h3>
<p>Demandez √† Claude Code :</p>
<blockquote>
<p>Montre-moi √† nouveau le sch√©ma de fl√®ches entre les contextes, comme au Jour 2. S√©pare les appels directs (questions) et les √©v√©nements (annonces).</p>
</blockquote>
<p>Vous devriez voir quelque chose comme :</p>
<pre><code>Appels directs (questions) :
  Livres ‚Üí Comptes       (v√©rifier le membre)
  R√©unions ‚Üí Comptes     (v√©rifier le membre)

√âv√©nements (annonces) :
  R√©unions publie : {:membre_inscrit_reunion, ...}
    ‚Üê Notifications √©coute (si cr√©√©)
  Livres publie : {:vote_enregistre, ...}
    ‚Üê (personne n'√©coute encore, et c'est OK)</code></pre>
<h3>Ce que vous devez noter dans votre carnet</h3>
<blockquote class="notebook-prompt">
<p>‚úçÔ∏è Combien de fl√®ches directes avant la transformation ? Et apr√®s ?</p>
</blockquote>
<blockquote class="notebook-prompt">
<p>‚úçÔ∏è Est-ce que R√©unions mentionne encore Notifications dans son code ? (Normalement non.)</p>
</blockquote>
<p>M√™me si le nombre de fl√®ches n'a pas diminu√© de fa√ßon spectaculaire (vous n'avez que 3 contextes), le <strong>type</strong> de fl√®ches a chang√©. Les appels directs qui restent sont des questions l√©gitimes. Les annonces passent par le tableau d'affichage. C'est le principe qui compte ‚Äî sur un projet avec 10 contextes, la diff√©rence serait √©norme.</p>
<h3>Avant de partir ‚Äî sauvegardez</h3>
<pre data-lang="bash"><code>git add .
git commit -m "Jour 6 M9 : appels directs transform√©s en √©v√©nements PubSub"</code></pre>

      </div>
    </main>
    <button class="back-to-top" aria-label="Retour en haut">‚Üë</button>
  </div>
  <script src="nav.js"></script>
  <script src="app.js"></script>
</body>
</html>
