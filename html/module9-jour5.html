<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jour 5 ‚Äî Le tableau d'affichage en Elixir</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèóÔ∏è</text></svg>">
</head>
<body>
  <div class="app">
    <div id="sidebar-root"></div>
    <main class="main-content">
      <div class="module-content">

<h1>Jour 5 : Le tableau d'affichage en Elixir</h1>
<p class="module-subtitle"><em>Module 9 ‚Äî Le monolithe qui enfle</em></p>
<hr>
<h3>Avant de commencer</h3>
<p>Hier, vous avez compris le concept : certaines communications entre contextes sont des <strong>annonces</strong>, pas des <strong>questions</strong>. Vous avez √©crit des √©v√©nements en fran√ßais. Aujourd'hui, vous allez voir √† quoi √ßa ressemble dans le code.</p>
<div class="module-meta">
<div class="module-meta-item"><strong>Dur√©e :</strong> 1h30-2h</div>
<div class="module-meta-item"><strong>Ce qu'il vous faut :</strong> Votre dossier `mon_club` ouvert dans VSCode, Claude Code, votre carnet</div>
</div>
<hr>
<h3>Ce que vous allez faire</h3>
<p>Quittez Claude Code (<code>/exit</code>) et relancez une nouvelle session :</p>
<pre data-lang="bash"><code>claude</code></pre>
<p>Demandez √† Claude Code de vous montrer un exemple :</p>
<blockquote>
<p>Lis le code de mon projet.</p>
<p>Montre-moi un exemple simple de Phoenix.PubSub appliqu√© au club de lecture. Je veux voir :</p>
<ol>
<li>Un contexte qui publie un √©v√©nement (par exemple, R√©unions annonce qu'un membre s'est inscrit)</li>
<li>Un module qui √©coute cet √©v√©nement et r√©agit (par exemple, il affiche un log ou met √† jour quelque chose)</li>
</ol>
<p>Montre-moi le code mais ne modifie pas encore le projet. Je veux d'abord comprendre.</p>
</blockquote>
<h3>Ce que vous allez voir</h3>
<p>Claude va vous montrer deux morceaux de code. Prenez le temps de les lire.</p>
<p><strong>Le premier</strong> ‚Äî la publication (dans le contexte R√©unions) :</p>
<p>Quelque part dans la fonction d'inscription, vous verrez une ligne comme :</p>
<pre data-lang="elixir"><code>Phoenix.PubSub.broadcast(MonClub.PubSub, "reunions", {:membre_inscrit, %{membre_id: membre_id, reunion_id: reunion_id}})</code></pre>
<p>C'est <strong>l'affichage sur le tableau</strong>. R√©unions dit : "quelqu'un s'est inscrit" et donne les d√©tails. Il ne sait pas qui va lire cette note. Il s'en fiche.</p>
<p><strong>Le deuxi√®me</strong> ‚Äî l'√©coute (un module Listener) :</p>
<pre data-lang="elixir"><code>defmodule MonClub.Notifications.Listener do
  use GenServer

  def start_link(_) do
    GenServer.start_link(__MODULE__, [])
  end

  def init(_) do
    Phoenix.PubSub.subscribe(MonClub.PubSub, "reunions")
    {:ok, %{}}
  end

  def handle_info({:membre_inscrit, %{membre_id: id, reunion_id: rid}}, state) do
    # R√©agir √† l'√©v√©nement ‚Äî par exemple, envoyer une notification
    IO.puts("Notification : le membre #{id} s'est inscrit √† la r√©union #{rid}")
    {:noreply, state}
  end
end</code></pre>
<p>C'est <strong>le d√©partement qui regarde le tableau</strong>. Il s'est abonn√© aux annonces de R√©unions, et quand il en voit une qui l'int√©resse, il r√©agit.</p>
<h3>Ce qu'il faut comprendre (et ce qu'on peut ignorer)</h3>
<p>Vous voyez <code>use GenServer</code>, <code>init</code>, <code>handle_info</code>, <code>{:noreply, state}</code>. √áa fait beaucoup de mots nouveaux. Voici ce que vous devez retenir :</p>
<p><strong>Ce qui compte :</strong></p>
<ul>
<li><code>Phoenix.PubSub.broadcast(...)</code> ‚Üí c'est l'annonce sur le tableau</li>
<li><code>Phoenix.PubSub.subscribe(...)</code> ‚Üí c'est "je regarde le tableau"</li>
<li><code>{:membre_inscrit, ...}</code> ‚Üí c'est le nom de l'√©v√©nement (celui que vous avez √©crit en fran√ßais hier)</li>
</ul>
<p><strong>Ce qu'on peut ignorer :</strong></p>
<ul>
<li><code>use GenServer</code>, <code>start_link</code>, <code>init</code>, <code>{:noreply, state}</code> ‚Üí c'est de la <dfn title="Du code technique n√©cessaire au fonctionnement mais qu'on n'a pas besoin de comprendre en d√©tail">plomberie</dfn>. Claude a cr√©√© un module qui tourne en arri√®re-plan et r√©agit aux √©v√©nements. Vous n'avez pas besoin de comprendre la m√©canique interne ‚Äî retenez juste qu'il √©coute et r√©agit.</li>
</ul>
<p>C'est comme au Jour 1 du M8 quand vous voyiez <code>use</code>, <code>import</code>, <code>alias</code> dans le code : de la plomberie n√©cessaire, pas le sujet du jour.</p>
<hr>
<h3>L'exercice : retrouver vos √©v√©nements</h3>
<p>Reprenez les √©v√©nements que vous avez √©crits en fran√ßais au Jour 4. Retrouvez-les dans le code que Claude vous a montr√©.</p>
<p>Par exemple :</p>
<ul>
<li>Votre phrase : "Marie s'est inscrite √† la Soir√©e Polar"</li>
<li>Dans le code : <code>{:membre_inscrit, %{membre_id: ..., reunion_id: ...}}</code></li>
</ul>
<blockquote class="notebook-prompt">
<p>‚úçÔ∏è Pour chaque √©v√©nement fran√ßais du Jour 4, √©crivez √† c√¥t√© le nom Elixir correspondant. La traduction devrait √™tre naturelle ‚Äî si le nom en code ne ressemble pas √† la phrase en fran√ßais, c'est un signal d'alerte.</p>
</blockquote>
<h3>Ce que vous devez noter dans votre carnet</h3>
<blockquote class="notebook-prompt">
<p>‚úçÔ∏è Quelle ligne publie l'√©v√©nement ? (Recopiez-la.)</p>
</blockquote>
<blockquote class="notebook-prompt">
<p>‚úçÔ∏è Quelle ligne √©coute l'√©v√©nement ? (Recopiez-la.)</p>
</blockquote>
<blockquote class="notebook-prompt">
<p>‚úçÔ∏è Est-ce que le contexte qui publie mentionne le module qui √©coute ? (Non ‚Äî et c'est le point crucial.)</p>
</blockquote>

      </div>
    </main>
    <button class="back-to-top" aria-label="Retour en haut">‚Üë</button>
  </div>
  <script src="nav.js"></script>
  <script src="app.js"></script>
</body>
</html>
